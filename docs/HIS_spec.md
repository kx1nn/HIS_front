# åŒ»é™¢ä¿¡æ¯ç³»ç»Ÿï¼ˆHISï¼‰æ–‡æ¡£

> æœ¬æ–‡æ¡£ä¸ºå‰ç«¯å·¥ç¨‹çš„æŠ€æœ¯æ–‡æ¡£ä¸åŠŸèƒ½æ–‡æ¡£ï¼Œé€‚åˆç›´æ¥ç”¨ä½œ PPT å†…å®¹æˆ–é¡¹ç›®è¯´æ˜ä¹¦æ‘˜è¦ã€‚

---

## ğŸ“Œ æ¦‚è¦

- **é¡¹ç›®**ï¼šHIS å‰ç«¯ï¼ˆReact + TypeScript + Viteï¼‰
- **ä»“åº“ç»“æ„ï¼ˆé‡ç‚¹ï¼‰**ï¼š
  - é¡µé¢ï¼š`src/pages/*`ï¼ˆ`DoctorStation`ã€`NurseStation`ã€`PharmacyStation`ã€`Admin`ã€`Login`ï¼‰
  - é€šç”¨ç»„ä»¶ï¼š`src/components/*`
  - æœåŠ¡ï¼š`src/services/*`ï¼ˆ`api.ts`ã€`authStorage.ts`ã€`logger.ts`ï¼‰
  - çŠ¶æ€ï¼š`src/store/store.ts`

---

## ğŸ”§ æŠ€æœ¯æ–‡æ¡£ï¼ˆTechnical Specï¼‰

### 1. æŠ€æœ¯æ ˆ

- å‰ç«¯ï¼š**React + TypeScript + Vite**
- æ ·å¼ï¼šPostCSS
- çŠ¶æ€ï¼šé¡¹ç›®å†…ç½® `store`ï¼ˆè¯¦è§ `src/store/store.ts`ï¼‰
- ç½‘ç»œï¼šå°è£… API (`src/services/api.ts`)ï¼Œé‰´æƒç®¡ç† (`src/services/authStorage.ts`)
- å·¥å…·ï¼šESLintã€Jestï¼ˆæ¨èï¼‰ã€Cypressï¼ˆå»ºè®®ï¼‰

### 2. ç³»ç»Ÿæ¶æ„

- æµè§ˆå™¨ â†’ CDNï¼ˆå¯é€‰ï¼‰ â†’ å‰ç«¯åº”ç”¨ â†’ API Gateway â†’ åç«¯å¾®æœåŠ¡ â†’ æ•°æ®åº“
- å»ºè®®ï¼šä½¿ç”¨ Docker + Kubernetes éƒ¨ç½²ã€CI/CDï¼ˆGitHub Actionsï¼‰

### 3. æ¥å£ç¤ºä¾‹

- POST `/api/auth/login` â†’ è¿”å› `accessToken`ã€`refreshToken`
- POST `/api/charges` â†’ åˆ›å»ºæ”¶è´¹å•
- PUT `/api/charges/:id/status` â†’ ä¿®æ”¹æ”¶è´¹å•çŠ¶æ€ï¼ˆ`settle` / `refund`ï¼‰

### 4. æ•°æ®æ¨¡å‹ï¼ˆç¤ºä¾‹ï¼‰

- Patient { id, name, dob, sex, contacts }
- Charge { id, patientId, items[], total, status, createdBy }

### 5. å®‰å…¨ & åˆè§„

- é‰´æƒï¼šJWT + Refresh Token
- ä¼ è¾“ï¼šHTTPS å¼ºåˆ¶
- å‰ç«¯å­˜å‚¨ï¼šä½¿ç”¨ `authStorage` å°è£…ï¼Œé¿å…æ˜æ–‡ localStorage
- å®¡è®¡ï¼šå…³é”®æ“ä½œä¸ŠæŠ¥æ—¥å¿—ï¼ˆ`logger.ts`ï¼‰

### 6. éåŠŸèƒ½éœ€æ±‚

- å¯ç”¨æ€§ï¼šç¤ºä¾‹ 99.9%
- å“åº”æ—¶é—´ï¼šå…³é”® API < 500ms
- å¹¶å‘ä¸æ‰©å±•ï¼šæ ¹æ®åŒ»é™¢è§„æ¨¡è®¾å®š

### 7. è¿ç»´å»ºè®®

- ç›‘æ§ï¼šPrometheus + Grafana
- æ—¥å¿—ï¼šé›†ä¸­åŒ–ï¼ˆELK/EFKï¼‰
- å¤‡ä»½ï¼šæ•°æ®åº“ä¸å…³é”®é…ç½®å®šæœŸå¤‡ä»½

---

## ğŸ§© åŠŸèƒ½æ–‡æ¡£ï¼ˆFunctional Specï¼‰

### ç™»å½•æ¨¡å—

- åŠŸèƒ½ï¼šè´¦å·ç™»å½•ã€è§’è‰²åˆ‡æ¢ã€é”™è¯¯æç¤º
- éªŒæ”¶ï¼šæ­£ç¡®å‡­è¯å®Œæˆè·³è½¬ï¼›é”™è¯¯æœ‰æ˜ç¡®æç¤ºï¼›æ”¯æŒè¶…æ—¶/åˆ·æ–°ç­–ç•¥

### åŒ»ç”Ÿå·¥ä½œå°

- åŠŸèƒ½ï¼šæŸ¥çœ‹ç—…äººã€å¼€åŒ»å˜±ã€æŸ¥çœ‹æ£€éªŒç»“æœ
- éªŒæ”¶ï¼šåŒ»å˜±èƒ½æ­£ç¡®æäº¤å¹¶åœ¨åç«¯ç”Ÿæˆè®°å½•

### æŠ¤å£« â€” æ”¶è´¹ç®¡ç†ï¼ˆ`src/pages/NurseStation/ChargeManagement.tsx`ï¼‰

- åŠŸèƒ½ï¼šåˆ›å»º/ç¼–è¾‘/åˆ é™¤æ”¶è´¹é¡¹ã€è®¡ç®—åˆè®¡ã€æŠ˜æ‰£ã€ç»“ç®—ã€é€€æ¬¾ã€æ‰“å°å‘ç¥¨
- éªŒæ”¶ï¼šåˆ›å»ºåä¸ºâ€œæœªç»“ç®—â€ï¼Œç»“ç®—åçŠ¶æ€å˜ä¸ºâ€œå·²ç»“ç®—â€ï¼Œåç«¯è®°è´¦

### è¯æˆ¿å·¥ä½œå°

- åŠŸèƒ½ï¼šå¤„æ–¹åˆ—è¡¨ã€é…è¯ã€åº“å­˜æ‰£å‡ã€å‘è¯æ—¥å¿—
- éªŒæ”¶ï¼šé…è¯æˆåŠŸååº“å­˜æ­£ç¡®æ›´æ–°ï¼Œä½åº“å­˜è§¦å‘é¢„è­¦

### ç®¡ç†åå°

- åŠŸèƒ½ï¼šç”¨æˆ·ä¸æƒé™ç®¡ç†ã€æŠ¥è¡¨å¯¼å‡ºã€ç³»ç»Ÿé…ç½®
- éªŒæ”¶ï¼šè§’è‰²æƒé™ç”Ÿæ•ˆã€æŠ¥è¡¨æ•°æ®å‡†ç¡®

## å®ç°ç›®æ ‡

- å®ç°åŸºç¡€å‰ç«¯åŠŸèƒ½æ¨¡å—ï¼šç™»å½•ã€åŒ»ç”Ÿã€æŠ¤å£«ï¼ˆæ”¶è´¹ï¼‰ã€è¯æˆ¿ã€ç®¡ç†åå°
- å®Œæˆå‰åç«¯åŸºæœ¬äº¤äº’ï¼ˆAPI å°è£…ã€é‰´æƒï¼‰å¹¶ä¿è¯æ¼”ç¤ºå¯è¿è¡Œ
- æäº¤ä»£ç ä¸é¡¹ç›®æ–‡æ¡£ï¼Œå¹¶åœ¨è¯¾å ‚å±•ç¤ºä¸­å®Œæˆ 10 åˆ†é’Ÿæ¼”ç¤º

## æµ‹è¯•ç»“æœæ‘˜è¦

- å•å…ƒæµ‹è¯•ï¼šå·²è¦†ç›–ç»„ä»¶/å·¥å…·å‡½æ•°ï¼ˆå¦‚æœ‰ï¼‰â€”â€”è¯·åœ¨ `package.json` ä¸­è¡¥å……æµ‹è¯•è„šæœ¬å¹¶è¿è¡Œ `pnpm test`
- æ‰‹åŠ¨æµ‹è¯•ï¼šç™»å½•ã€æŠ¤å£«æ”¶è´¹ã€ç»“ç®—æµç¨‹å·²é€šè¿‡æœ¬åœ°æ‰‹åŠ¨éªŒè¯
- æ€§èƒ½ï¼šé¡µé¢å“åº”è‰¯å¥½ï¼›æœªåšå¤§è§„æ¨¡å¹¶å‘å‹æµ‹ï¼ˆå»ºè®®å†™å…¥åç»­æ”¹è¿›ï¼‰

## å·²å®Œæˆ / æœªå®Œæˆ æ¸…å•

- å·²å®Œæˆï¼š
  - ç™»å½•ã€æŠ¤å£«æ”¶è´¹ UIã€æ”¶è´¹è®¡ç®—é€»è¾‘ã€åŸºç¡€ API å°è£…ã€è·¯ç”±å®ˆå«
  - ä»£ç ç»“æ„ä¸éƒ¨åˆ†å•å…ƒæµ‹è¯•ï¼ˆå¦‚æœ‰ï¼‰
- æœªå®Œæˆï¼ˆå¯ä½œä¸ºåŠ åˆ†é¡¹ï¼‰ï¼š
  - å®Œæ•´ E2E æµ‹è¯•è¦†ç›–ï¼ˆCypressï¼‰ã€æ›´å®Œå–„çš„æƒé™ç»†ç²’åº¦æ§åˆ¶
  - æ‰“å°/å¯¼å‡ºæ ·å¼ä¼˜åŒ–ã€å‘ç¥¨ PDF æ¨¡æ¿å®Œå–„ã€æ‰“å°é€‚é…
  - åç«¯äº‹åŠ¡ä¸€è‡´æ€§/å¹¶å‘åœºæ™¯çš„è‡ªåŠ¨åŒ–æµ‹è¯•

## è¯„åˆ†æ ‡å‡†ï¼ˆå»ºè®®ç»™è€å¸ˆå‚è€ƒï¼‰

1. åŠŸèƒ½å®ç°ï¼ˆ50%ï¼‰ï¼šä¸»è¦åŠŸèƒ½æ˜¯å¦èƒ½æŒ‰è¦æ±‚æ¼”ç¤ºï¼ˆç™»å½•ã€æ”¶è´¹ã€ç»“ç®—ã€é…è¯ï¼‰
2. ä»£ç è´¨é‡ï¼ˆ20%ï¼‰ï¼šç»“æ„æ¸…æ™°ã€æ³¨é‡Šã€ç±»å‹ä½¿ç”¨ã€é”™è¯¯å¤„ç†
3. æ–‡æ¡£ä¸æ¼”ç¤ºï¼ˆ15%ï¼‰ï¼šæ–‡æ¡£å®Œæ•´ã€æ¼”ç¤ºæœ‰æ¡ç†ã€æ—¶é—´æ§åˆ¶
4. æµ‹è¯•ä¸å¯é æ€§ï¼ˆ10%ï¼‰ï¼šå•å…ƒæµ‹è¯•ã€æ‰‹åŠ¨æµ‹è¯•è¦†ç›–ã€å¼‚å¸¸å¤„ç†
5. åˆ›æ–°ä¸æ‰©å±•ï¼ˆ5%ï¼‰ï¼šé¢å¤–åŠŸèƒ½æˆ–ä¼˜åŒ–ï¼ˆä½é…é«˜å¯ç”¨æ–¹æ¡ˆã€ç›‘æ§ã€CIï¼‰

## é€é¡µæ¼”ç¤ºç¨¿ï¼ˆç®€çŸ­è®²ç¨¿ / æç¤ºè¯ï¼‰

- Slide 1ï¼šæ ‡é¢˜é¡µ
  - ã€Œå„ä½è€å¸ˆã€åŒå­¦å¥½ï¼Œæˆ‘ä»¬çš„é¡¹ç›®æ˜¯åŸºäº React çš„é™¢å†… HIS å‰ç«¯ï¼Œä¸»è¦å®ç°äº†æŠ¤å£«æ”¶è´¹ã€è¯æˆ¿ã€åŒ»ç”Ÿå·¥ä½œå°ä¸ç®¡ç†åå°çš„åŸºç¡€åŠŸèƒ½ã€‚ã€
- Slide 2ï¼šé¡¹ç›®æ¦‚è¿°
  - ã€Œç›®æ ‡æ˜¯æ„å»ºå¯æ¼”ç¤ºçš„é™¢å†…å‰ç«¯ç³»ç»Ÿï¼Œé‡‡ç”¨ React + TypeScript + Viteï¼Œæé«˜å¼€å‘æ•ˆç‡å¹¶ä¾¿äºæ‰©å±•ã€‚ã€
- Slide 3ï¼šå…³é”®ä¸šåŠ¡æµç¨‹
  - ã€Œè¿™é‡Œä»¥æ”¶è´¹æµç¨‹ä¸ºä¾‹ï¼Œæ¼”ç¤ºä»å»ºå•åˆ°ç»“ç®—çš„å®Œæ•´é—­ç¯ã€‚ã€
- Slide 4ï¼šæŠ€æœ¯æ¶æ„
  - ã€Œå‰ç«¯é‡‡ç”¨ç»„ä»¶åŒ–ã€å°è£…äº† API ä¸é‰´æƒï¼Œå»ºè®®éƒ¨ç½²äº CDN + å‰ç«¯ä¸»æœºï¼Œåç«¯ä½¿ç”¨å¾®æœåŠ¡ã€‚ã€
- Slide 5ï¼šæ¼”ç¤ºï¼ˆç°åœºæ¼”ç¤ºé¡µé¢ï¼‰
  - ç°åœºæ¼”ç¤ºæŠ¤å£«æ”¶è´¹ï¼šæ–°å»ºæ”¶è´¹å• â†’ æ·»åŠ é¡¹ç›® â†’ ç»“ç®— â†’ æŸ¥çœ‹è´¦ç›®
- Slide 6ï¼šæµ‹è¯•ä¸å·²çŸ¥é—®é¢˜
  - ã€Œåˆ—å‡ºå·²é€šè¿‡æµ‹è¯•ä¸è‹¥å¹²æœªå®Œæˆé¡¹ï¼Œå¹¶è¯´æ˜æœªæ¥è®¡åˆ’ã€‚ã€
- Slide 7ï¼šç»“è®ºä¸ç­”ç–‘
  - ã€Œæ€»ç»“å®ç°è¦ç‚¹ã€æ”¶è·ä¸åç»­æ”¹è¿›è®¡åˆ’ï¼Œæ¬¢è¿æé—®ã€‚ã€

## å‚è€ƒæ–‡çŒ®ä¸è‡´è°¢

- React æ–‡æ¡£ã€TypeScript æŒ‡å—ã€Vite å®˜æ–¹æ–‡æ¡£
- æœ¬é¡¹ç›®ä¸­ä½¿ç”¨çš„å¼€æºåº“

---

## æµç¨‹å›¾ï¼ˆé™„å›¾ï¼‰
ä¸‹é¢é™„ä¸Šå¸¸ç”¨æµç¨‹å›¾ï¼ˆSVG æ–‡ä»¶ä½äº `docs/diagrams/`ï¼‰ï¼Œå¯ç›´æ¥åœ¨ PPT ä¸­åµŒå…¥æˆ–æ‰“å°ï¼š

### æŠ¤å£«æ”¶è´¹æµç¨‹
![æŠ¤å£«æ”¶è´¹æµç¨‹](./diagrams/charge_flow.svg)

> æè¿°ï¼šä»é€‰æ‹©ç—…äººåˆ°ç”Ÿæˆå‘ç¥¨å¹¶è®°è´¦çš„å®Œæ•´é—­ç¯ï¼Œé€‚åˆä½œä¸ºè¯¾å ‚æ¼”ç¤ºçš„ä¸»æµç¨‹ã€‚

### ç™»å½•ä¸æƒé™æµç¨‹
![ç™»å½•ä¸æƒé™æµç¨‹](./diagrams/login_flow.svg)

> æè¿°ï¼šå±•ç¤ºå‰ç«¯ç™»å½•ã€å‡­è¯éªŒè¯ã€è§’è‰²åŠ è½½ä¸å¯¼èˆªçš„æµç¨‹ã€‚

### è¯æˆ¿é…è¯æµç¨‹
![è¯æˆ¿é…è¯æµç¨‹](./diagrams/pharmacy_flow.svg)

> æè¿°ï¼šä»æ¥æ”¶å¤„æ–¹åˆ°é…è¯å‡ºåº“ã€åº“å­˜æ›´æ–°ä¸å¼‚å¸¸å¤„ç†çš„æµç¨‹ã€‚

### åŒ»ç”Ÿç—…å†ä¸å¼€åŒ»å˜±æµç¨‹
![åŒ»ç”Ÿç—…å†ä¸å¼€åŒ»å˜±æµç¨‹](./diagrams/doctor_flow.svg)

> æè¿°ï¼šåŒ»ç”ŸæŸ¥çœ‹ç—…äººä¿¡æ¯ã€æŸ¥çœ‹æ£€éªŒç»“æœã€å¼€ç«‹åŒ»å˜±å¹¶ä¸‹å‘åˆ°è¯æˆ¿æˆ–æ£€æŸ¥ç§‘å®¤ã€‚

### éƒ¨ç½²æ¶æ„ç¤ºæ„å›¾
![éƒ¨ç½²æ¶æ„ç¤ºæ„å›¾](./diagrams/deploy_arch.svg)

> æè¿°ï¼šå‰ç«¯æ‰˜ç®¡ã€API ç½‘å…³ã€é‰´æƒæœåŠ¡ã€å¾®æœåŠ¡ä¸æ•°æ®åº“çš„é«˜å±‚æ¬¡ç¤ºæ„ã€‚

---

**æäº¤è¯´æ˜**ï¼šæœ¬æ–‡ä»¶ä½œä¸ºè¯¾ç¨‹ä½œä¸šè¯´æ˜æ–‡æ¡£ï¼Œå¯ç›´æ¥ç”¨äºè¯¾å ‚å±•ç¤ºæˆ–ä½œä¸ºæäº¤ææ–™ï¼Œè‹¥éœ€æˆ‘æŠŠè¯¥æ–‡æ¡£è½¬ä¸º PPTï¼ˆå«æ¯é¡µè®²ç¨¿ï¼‰è¯·å›å¤â€œç”Ÿæˆ PPTâ€ã€‚

**æ–‡ä»¶ä½ç½®**ï¼š`docs/HIS_spec.md` (è¯¾ç¨‹ä½œä¸šç‰ˆ)
